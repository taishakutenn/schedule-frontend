# Описание
Файл: `src\components\Modal\ModalForm.jsx`
Компонент `ModalForm` представляет собой универсальную форму для добавления и редактирования записей, встроенную в модальное окно.
# Пропсы
## Обязательные
### isOpen
![[Модальное окно#isOpen]]
### onClose
![[Модальное окно#onClose]]
### handbook
Имя справочника/типа данных, определяет, какую конфигурацию формы использовать.
### onSubmit
Функция для обработки отправки формы. В режиме редактирования принимает объект обновленных данных, объект идентификаторов и коллбэк. В режиме создания принимает объект данных и коллбэк.
## Опциональные
### rowData
Данные строки для редактирования. Если переданы, форма работает в режиме редактирования и предзаполняется значениями. По умолчанию `null`.
### loading
Индикатор состояния загрузки. Блокирует взаимодействие с формой и изменяет текст кнопки. По умолчанию `false`.
### error
Сообщение об ошибке для отображения в форме. По умолчанию `null`.
# Переменные 
## Вспомогательные переменные
- **`config`** - Конфигурация формы, полученная из `formConfig` по ключу `handbook`. Определяет структуру полей и их настройки.
- **`filteredFormData`** - Объект, содержащий данные формы без пустых значений для режима создания новой записи.
- **`updateData`** - Объект, содержащий только изменённые значения полей для режима обновления существующей записи.
- **`idData`** - Объект, содержащий первичные ключи с их оригинальными значениями для идентификации записи при обновлении.
- **`value`** - Текущее значение конкретного поля формы, используемое при отрисовке полей.
- **`data`** - Данные, полученные из API для динамических выпадающих списков.
- **`loading`** - Состояние загрузки данных из API для динамических выпадающих списков.
- **`error`** - Ошибка, возникшая при загрузке данных из API для динамических выпадающих списков.
## Переменные конфигурации полей:
- **`fieldConfig`** - Объект конфигурации конкретного поля, содержащий тип, обязательность, настройки API и другие параметры.
- **`apiFunction`** - Название функции API для получения данных динамического выпадающего списка.
- **`labelField`** - Поле или массив полей, используемых для отображения метки в выпадающем списке.
- **`valueField`** - Поле, используемое в качестве значения в выпадающем списке.
- **`name`** - Имя поля, используемое как ключ в объекте данных.
- **`type`** - Тип поля (например, text, select, number).
- **`placeholder`** - Текст-заполнитель для поля ввода.
- **`required`** - Признак обязательности заполнения поля.
- **`options`** - Массив опций для обычных выпадающих списков.
- **`dynamicOptions`** - Признак использования динамических опций из API.
- **`isPrimaryKey`** - Признак того, что поле является первичным ключом.
- **`newNameForUpdate`** - Альтернативное имя поля для обновления (используется при изменении ключевых полей).
# Функции
## handleChange(e)
Обработчик изменения значения в полях формы. Получает имя и значение поля из события и обновляет состояние `formData`, объединяя новые значения с существующими.
## handleSubmit(e) 
Обработчик отправки формы. Предотвращает стандартное поведение формы, обрабатывает данные в зависимости от режима (создание или редактирование), фильтрует пустые значения, обрабатывает первичные ключи и вызывает внешнюю функцию `onSubmit` с подготовленными данными.
## DynamicSelect(props)
Компонент для отображения динамических выпадающих списков, загружающих опции из API. Принимает конфигурацию поля, текущее значение и обработчики. Использует кастомный хук [[useApiData]] для получения данных и отображает опции в виде списка выбора.
## getDisplayLabel(item, labelField)
Вспомогательная функция для формирования отображаемой метки из нескольких полей. Принимает объект данных и массив полей, возвращает объединённую строку значений этих полей.
## renderField(fieldConfig)
Функция для отрисовки конкретного поля формы в зависимости от его конфигурации. Определяет тип поля и возвращает соответствующий элемент интерфейса (input, select и т.д.).
# Хуки
## useEffect
Синхронизирует состояние `formData` с `rowData` при открытии модального окна. Если переданы данные строки, заполняет форму этими данными, иначе очищает форму.
# Базовая структура
## Внешняя обертка:
- **Модальное окно** - использует компонент `Modal` с заголовком, зависящим от режима (редактирование или создание)
- Размер модального окна установлен на `sm` (маленький)
## Основная форма:
- **Контейнер формы** - HTML элемент `<form>` с обработчиком отправки
- **Контейнер полей** - div с классом `teacher-add-container`, содержащий все поля ввода
## Поля формы:
- **Статические поля** - инпуты различных типов (text, number, email и т.д.), создаваемые на основе конфигурации
- **Выпадающие списки** - обычные select с фиксированными опциями
- **Динамические выпадающие списки** - select, загружающие опции из API с помощью кастомного компонента `DynamicSelect`
## Кнопка отправки:
- **Кнопка действия** - компонент `Button` с текстом, меняющимся в зависимости от режима:
    - В режиме редактирования: "Сохранить изменения"
    - В режиме создания: "Добавить"
    - При загрузке: "Отправка..."
## Обратная связь:
- **Сообщение об ошибке** - отображается при наличии ошибки в пропсе `error`
- **Индикатор загрузки** - блокирует форму и изменяет текст кнопки при состоянии `loading`
## Логика работы:
- Компонент автоматически переключается между режимами создания и редактирования в зависимости от наличия данных в `rowData`
- Для редактирования сравниваются старые и новые значения ключевых полей
- Форма предотвращает отправку пустых значений и обрабатывает специфичное поведение первичных ключей